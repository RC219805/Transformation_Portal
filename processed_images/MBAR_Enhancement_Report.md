# MBAR Board Material Enhancement - 750 Picacho Lane Aerial

**Date:** October 14, 2025  
**Project:** 800 Picacho Lane / 750 Picacho Lane Montecito Estate  
**Process:** Automated MBAR Material Application via K-Means Clustering

---

## Input

- **File:** `RC-office750Picacho_Aerial.tiff`
- **Resolution:** 2000 × 1200 pixels
- **Format:** TIFF (RGBA)
- **Source:** Aerial photograph of Montecito property

## Output

- **Enhanced File:** `750_Picacho_Aerial_MBAR_Enhanced.jpg`
- **Resolution:** 4096 × 2458 pixels (4K)
- **Format:** JPEG
- **File Size:** 0.95 MB
- **Visualization:** `750_Picacho_Material_Assignment_Map.jpg`

## Processing Parameters

- **Clustering:** K-means with k=8 color clusters
- **Analysis Resolution:** 1280px max dimension (downsampled for speed)
- **Random Seed:** 22 (reproducible results)
- **Target Resolution:** 4096px width (4K deliverable)

## MBAR Materials Applied

The Santa Barbara Montecito Board of Architectural Review (MBAR) approved palette includes:

### Assigned Materials (5 of 8)

| Material | Cluster | Coverage | Color Profile |
|----------|---------|----------|---------------|
| **PLASTER** (Marmorino Palladino) | 2 | 17.8% | Light neutral beige, low saturation |
| **ROOF** (Bison Weathered Ipe) | 0 | 9.5% | Mid-tone neutral gray |
| **EQUITONE** (LT85 Panels) | 7 | 11.6% | Dark neutral gray |
| **SHADE** (Louvretec Powder White) | 1 | 5.6% | Bright white, minimal saturation |
| **SCREENS** (Grey Gum) | 4 | 5.3% | Mid-tone neutral |

### Available but Not Assigned (3 of 8)

- **STONE** (Eco Outdoor Bokara) - Warm coastal stone
- **CLADDING** (Sculptform warm timber) - Warm wood tones
- **BRONZE** (Dark bronze anodized) - Dark warm metal

### Unassigned Clusters (3)

- **Cluster 3:** 21.9% - Landscape vegetation (no material match)
- **Cluster 5:** 16.6% - Sky/background (no material match)
- **Cluster 6:** 11.7% - Shadow regions (no material match)

## Technical Details

### Algorithm

1. **Color Clustering:** K-means clustering on downsampled image (200K pixel sample max)
2. **HSV Analysis:** Cluster statistics computed in both RGB and HSV color spaces
3. **Material Scoring:** Each material has a custom scoring function based on HSV characteristics
4. **Greedy Assignment:** Materials assigned to best-matching clusters above threshold
5. **Texture Blending:** High-res texture plates blended with soft Gaussian masks (radius 1.5px)
6. **Upscaling:** Result scaled to 4K using Lanczos resampling

### Material Detection Heuristics

- **Plaster:** High value, low saturation (bright neutral)
- **Stone:** Warm hue (~0.09), mid saturation, mid value
- **Roof:** Neutral, mid-high value
- **Equitone:** Neutral, low-mid value (dark panels)
- **Shade:** Very high value, low saturation (white)
- **Screens:** Neutral, mid value
- **Cladding:** Warm hue, mid saturation
- **Bronze:** Dark warm tone

## Texture Sources

Procedurally generated placeholder textures at 512×512px with:

- Base colors matching MBAR material specifications
- Subtle Gaussian noise (σ=8) for surface variation
- Gradient overlay for depth perception
- PNG format for quality retention

**Location:** `/workspaces/800-Picacho-Lane-LUTs/textures/board_materials/`

## Deliverables

1. ✅ **Enhanced 4K Aerial** - `750_Picacho_Aerial_MBAR_Enhanced.jpg`
2. ✅ **Material Assignment Map** - `750_Picacho_Material_Assignment_Map.jpg`
3. ✅ **Board Material Textures** - 8 texture plates in `textures/board_materials/`

## Notes

- **Coverage:** 49.8% of image successfully assigned to MBAR materials
- **Unassigned:** 50.2% consists primarily of landscape and sky (expected)
- **Blend Strength:** 45-65% texture opacity preserves aerial photo detail
- **Reproducibility:** Fixed seed (22) ensures consistent clustering across runs

## Recommendations

### For Presentation

- The enhanced aerial emphasizes the approved material palette
- Material assignment map shows architectural clustering accuracy
- 4K resolution suitable for MBAR board presentation materials

### For Iteration

To adjust material detection:

- Modify HSV thresholds in `build_material_rules()` scoring functions
- Adjust `min_score` values to control assignment sensitivity
- Increase `k` (clusters) to capture more material variation
- Adjust `blend` values (0.0-1.0) to control texture strength

### For Production

- Replace placeholder textures with actual material photography
- Consider adding GPS/IPTC metadata preservation
- Add watermarking for client deliverables
- Integrate with existing `luxury_tiff_batch_processor.py` workflow

---

**Generated by:** `board_material_aerial_enhancer.py`  
**Command:** `python run_aerial_enhancement.py`  
**Processing Time:** ~1-2 seconds (includes clustering and 4K upscaling)
